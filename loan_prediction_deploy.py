# -*- coding: utf-8 -*-
"""loan_prediction_deploy.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mmo7cVZJghd1IS1DPjr0nD0YWJTGd_iw
"""

import streamlit as st
import pandas as pd
import pickle

# Load saved files
model = pickle.load(open("loan_prediction_model.pkl", "rb"))
encoders = pickle.load(open("label_encoder.pkl", "rb"))
feature_columns = pickle.load(open("features.pkl", "rb"))

st.title("Loan Prediction App")

# User Inputs
gender = st.selectbox("Gender", ["Male", "Female"])
married = st.selectbox("Married", ["Yes", "No"])
education = st.selectbox("Education", ["Graduate", "Not Graduate"])
self_employed = st.selectbox("Self Employed", ["Yes", "No"])
applicant_income = st.number_input("Applicant Income")
loan_amount = st.number_input("Loan Amount")
property_area = st.selectbox("Property Area", ["Urban", "Semiurban", "Rural"])

# When Predict Button Clicked
if st.button("Predict"):

    # Create dictionary
    input_dict = {
        "Gender": gender,
        "Married": married,
        "Education": education,
        "Self_Employed": self_employed,
        "ApplicantIncome": applicant_income,
        "LoanAmount": loan_amount,
        "Property_Area": property_area
    }

    # Convert to DataFrame
    input_df = pd.DataFrame([input_dict])

    # Apply Label Encoding
    for col in encoders:
        if col != "Loan_Status":
            input_df[col] = encoders[col].transform(input_df[col])

    # Reorder columns SAME as training
    input_df = input_df[feature_columns]

    # Predict
    prediction = model.predict(input_df)

    if prediction[0] == 1:
        st.success("Loan Approved ✅")
    else:
        st.error("Loan Rejected ❌")
