# -*- coding: utf-8 -*-
"""loan_prediction_deploy.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mmo7cVZJghd1IS1DPjr0nD0YWJTGd_iw
"""

import streamlit as st
import pandas as pd
import pickle
import os

# -------- LOAD MODEL --------
model_path = "loan_prediction_model.pkl"
encoder_path = "label_encoder.pkl"

if not os.path.exists(model_path):
    st.error("Model file not found!")
    st.stop()

if not os.path.exists(encoder_path):
    st.error("Encoder file not found!")
    st.stop()

model = pickle.load(open(model_path, "rb"))
encoders = pickle.load(open(encoder_path, "rb"))

st.title("Loan Prediction App")

# -------- USER INPUT --------
gender = st.selectbox("Gender", ["Male", "Female"])
married = st.selectbox("Married", ["Yes", "No"])
education = st.selectbox("Education", ["Graduate", "Not Graduate"])
self_employed = st.selectbox("Self Employed", ["Yes", "No"])
applicant_income = st.number_input("Applicant Income")
loan_amount = st.number_input("Loan Amount")
property_area = st.selectbox("Property Area", ["Urban", "Semiurban", "Rural"])

# -------- PREDICTION --------
if st.button("Predict"):

    input_dict = {
        "Gender": gender,
        "Married": married,
        "Education": education,
        "Self_Employed": self_employed,
        "ApplicantIncome": applicant_income,
        "LoanAmount": loan_amount,
        "Property_Area": property_area
    }

    input_df = pd.DataFrame([input_dict])

    # Apply encoders
    for col in encoders:
        if col in input_df.columns:
            input_df[col] = encoders[col].transform(input_df[col])

    # üî• IMPORTANT FIX (No features.pkl needed)
    input_df = input_df[model.feature_names_in_]

    prediction = model.predict(input_df)

    if prediction[0] == 1:
        st.success("Loan Approved ‚úÖ")
    else:
        st.error("Loan Rejected ‚ùå")
